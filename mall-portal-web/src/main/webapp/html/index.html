<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>首页</title>
    <link rel="stylesheet" type="text/css" href="../res/static/css/main.css">
    <link rel="stylesheet" type="text/css" href="../res/layui/css/layui.css">
    <script type="text/javascript" src="../res/layui/layui.js"></script>
    <script type="text/javascript" src="../res/static/js/util/jquery.min.js"></script>
    <script type="text/javascript" src="../res/static/js/common.js"></script>
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <script>
        $(function () {

            getTopBanner();
            getProductCateList();


            // 退出登录
            $("#logout").click(function () {
                clearCookies();
            });
        });

        //随机选取一个banner
        function getTopBanner() {
            $.ajax({
                type: "get",
                url: CONTENT_PATH + "/home/content",
                dataType: "json",//返回的
                success: function (data) {
                    console.log(data)
                    switch (data.code) {
                        case 200:
                            let length = data.data.advertiseList.length;
                            let random = parseInt(Math.random() * length);
                            var datum = (data.data.advertiseList)[random];
                            console.log(datum)
                            $("#top_banner").attr("src", datum.pic);

                            let hotProductList = data.data.hotProductList;
                            var hot_template = "<div class=\"layui-carousel\" id=\"test1\"><div carousel-item><div class=\"item-box\">";

                            hotProductList.forEach((item, index, arr) => {
                                var title = item.name.length > 12 ? item.name.substring(0, 12) : item.name;
                                hot_template += "<div class=\"item\">" +
                                    "    <a href=\"javascript:;\"><img src=\"" + item.pic + "\"></a>" +
                                    "    <div class=\"title\">" + (title + "...") + "</div>" +
                                    "    <div class=\"price\">" +
                                    "        <span>" + item.price + "</span>" +
                                    "        <del>" + item.originalPrice + "</del>" +
                                    "    </div>" +
                                    "</div>";
                                if ((index + 1) % 4 == 0) {

                                    hot_template += "</div>";
                                    hot_template += "<div class=\"item-box\">";

                                }
                            });
                            hot_template += "</div></div></div>";
                            $(".sk_bd").html(hot_template);
                            console.log(hot_template);
                            configLoop();

                            break;
                        // case 401:
                        //     toLogin();
                        //     break;
                    }


                },
                error: function (msg) {
                    console.log(msg)
                }
            });
        }

        //获取商品分类列表
        function getProductCateList() {
            $.ajax({
                type: "get",
                url: CONTENT_PATH + "/home/productCateAllList",
                dataType: "json",//返回的
                success: function (data) {
                    console.log(data)
                    switch (data.code) {
                        case 200:
                            var obj = data.data;
                            for (let key in obj) {
                                var type = "<li class=\"nav-item\">" +
                                    "                            <div class=\"title\">" + key + "</div>";
                                type += "                            <p>";
                                var curent = obj[key];
                                curent.forEach((item, index, arr) => {

                                    if (index < 4) {
                                        type += "<a href=\"#\">" + item.name + "</a>";
                                    }
                                });
                                type += "                            </p>";
                                type += "                            <i class=\"layui-icon layui-icon-right\"></i>" +
                                    "                        </li>";
                                $(".normal-nav").append(type);
                            }
                            ;


                            break;
                        // case 401:
                        //     toLogin();
                        //     break;
                    }


                },
                error: function (msg) {
                    console.log(msg)
                }
            });
        }
    </script>
</head>
<body id="list-cont">
<div class="site-nav-bg">
    <div class="site-nav w1200">
        <p class="sn-back-home">
            <i class="layui-icon layui-icon-home"></i>
            <a href="index.html">首页</a>
        </p>
        <div class="sn-quick-menu">
            <div class="login">
                <a id="userName" href="login.html">登录</a>
            </div>
            <div class="sp-cart" style="display: none;"><a href="shopcart.html">购物车</a><span id="shopcartCount">0</span>
            </div>
            <a id="logout" style="display:none;margin-left: 20px;" href="login.html">退出登录</a>
        </div>
    </div>
</div>


<div class="header">
    <div class="headerLayout w1200">
        <div class="headerCon">
            <h1 class="mallLogo">
                <a href="#" title="日销商城">
                    <img src="../res/static/img/logo.png">
                </a>
            </h1>
            <div class="mallSearch">
                <form action="" class="layui-form" novalidate>
                    <input type="text" name="title" required lay-verify="required" autocomplete="off"
                           class="layui-input" placeholder="请输入需要的商品">
                    <button class="layui-btn" lay-submit lay-filter="formDemo">
                        <i class="layui-icon layui-icon-search"></i>
                    </button>
                    <input type="hidden" name="" value="">
                </form>
            </div>
        </div>
    </div>
</div>


<div class="content">
    <div class="main-nav">
        <div class="inner-cont0">
            <div class="inner-cont1 w1200">
                <div class="inner-cont2">
                    <a href="commodity.html" class="active">所有商品</a>
                    <a href="buytoday.html">今日团购</a>
                    <a href="information.html">日销资讯</a>
                    <a href="about.html">关于我们</a>
                </div>
            </div>
        </div>
    </div>
    <div class="category-con">
        <div class="category-inner-con w1200">
            <div class="category-type">
                <h3>全部分类</h3>
            </div>
            <div class="category-tab-content">
                <div class="nav-con">
                    <ul class="normal-nav layui-clear">
                    </ul>
                </div>
            </div>
        </div>
        <div class="category-banner">
            <div class="w1200">
                <img id="top_banner" style="width: 1200px;height: 400px;">
            </div>
        </div>
    </div>
    <div class="floors">
        <div class="sk">
            <div class="sk_inner w1200">
                <div class="sk_hd">
                    <a href="javascript:;">
                        <img src="../res/static/img/s_img1.jpg">
                    </a>
                </div>
                <div class="sk_bd">

                </div>
            </div>
        </div>
    </div>


    <div class="hot-recommend-con">
        <div class="hot-con1 w1200 layui-clear">
            <div class="item">
                <h4>热销推荐</h4>
                <div class="big-img">
                    <a href="javascript:;"><img src="../res/static/img/hot1.png"></a>
                </div>
                <div class="small-img">
                    <a href="javascript:;"><img src="../res/static/img/hot2.png" alt=""></a>
                </div>
            </div>
            <div class="item">
                <div class="top-img">
                    <a href="javascript:;"><img src="../res/static/img/hot5.jpg"></a>
                </div>
                <div class="bottom-img">
                    <a href="javascript:;"><img src="../res/static/img/hot6.jpg"></a>
                    <a class="baby-cream" href="javascript:;"><img src="../res/static/img/hot7.jpg"></a>
                </div>
            </div>
            <div class="item item1 margin0 padding0">
                <a href="javascript:;"><img src="../res/static/img/hot8.jpg"></a>
                <a href="javascript:;"><img class="btm-img" src="../res/static/img/hot9.jpg"></a>
            </div>
        </div>
    </div>




    <div class="product-list-box" id="product-list-box">
        <div class="product-list-cont w1200">
            <h4>更多推荐</h4>
            <div class="product-item-box layui-clear">
                <div class="list-item">
                    <a href="javascript:;"><img src="../res/static/img/more1.jpg"></a>
                    <p>时尚宝宝小黄鸭T恤纯棉耐脏多色可选0-2岁宝宝</p>
                    <span>￥100.00</span>
                </div>
                <div class="list-item">
                    <a href="javascript:;"><img src="../res/static/img/more2.jpg"></a>
                    <p>时尚宝宝小黄鸭T恤纯棉耐脏多色可选0-2岁宝宝</p>
                    <span>￥100.00</span>
                </div>
                <div class="list-item">
                    <a href="javascript:;"><img src="../res/static/img/more3.jpg"></a>
                    <p>时尚宝宝小黄鸭T恤纯棉耐脏多色可选0-2岁宝宝</p>
                    <span>￥100.00</span>
                </div>
                <div class="list-item">
                    <a href="javascript:;"><img src="../res/static/img/more1.jpg"></a>
                    <p>时尚宝宝小黄鸭T恤纯棉耐脏多色可选0-2岁宝宝</p>
                    <span>￥100.00</span>
                </div>
                <div class="list-item">
                    <a href="javascript:;"><img src="../res/static/img/more2.jpg"></a>
                    <p>时尚宝宝小黄鸭T恤纯棉耐脏多色可选0-2岁宝宝</p>
                    <span>￥100.00</span>
                </div>


            </div>
        </div>
    </div>
</div>

<div class="footer">
    <div class="ng-promise-box">
        <div class="ng-promise w1200">
            <p class="text">
                <a class="icon1" href="javascript:;">7天无理由退换货</a>
                <a class="icon2" href="javascript:;">满99元全场免邮</a>
                <a class="icon3" style="margin-right: 0" href="javascript:;">100%品质保证</a>
            </p>
        </div>
    </div>
    <div class="mod_help w1200">
        <p>
            <a href="javascript:;">关于我们</a>
            <span>|</span>
            <a href="javascript:;">帮助中心</a>
            <span>|</span>
            <a href="javascript:;">售后服务</a>
            <span>|</span>
            <a href="javascript:;">日销资讯</a>
            <span>|</span>
            <a href="javascript:;">关于货源</a>
        </p>
        <p class="coty">日销商城版权所有 &copy; 2012-2020</p>
    </div>
</div>
<script type="text/javascript">


    function configLoop(){
        layui.config({
            base: '../res/static/js/util/' //你存放新模块的目录，注意，不是layui的模块目录
        }).use(['mm', 'carousel'], function () {
            var carousel = layui.carousel,
                mm = layui.mm;
            var option = {
                elem: '#test1'
                , width: '100%' //设置容器宽度
                , arrow: 'always'
                , height: '298'
                , indicator: 'none'
            }
            carousel.render(option);
            // 模版引擎导入
            // var ins = carousel.render(option);
            // var html = demo.innerHTML;
            // var listCont = document.getElementById('list-cont');
            // // console.log(layui.router("#/about.html"))
            //  mm.request({
            //    url: '../json/index.json',
            //    success : function(res){
            //      console.log(res)
            //      listCont.innerHTML = mm.renderHtml(html,res)
            //      ins.reload(option);
            //    },
            //    error: function(res){
            //      console.log(res);
            //    }
            //  })


        });
    }

</script>
</body>
</html>